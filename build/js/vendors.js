!function(t,e){"function"==typeof define&&define.amd?define(["jquery"],e):"object"==typeof exports?module.exports=e(require("jquery")):t.lightbox=e(t.jQuery)}(this,function(t){function e(e){this.album=[],this.currentImageIndex=void 0,this.init(),this.options=t.extend({},this.constructor.defaults),this.option(e)}return e.defaults={albumLabel:"Image %1 of %2",alwaysShowNavOnTouchDevices:!1,fadeDuration:600,fitImagesInViewport:!0,imageFadeDuration:600,positionFromTop:50,resizeDuration:700,showImageNumberLabel:!0,wrapAround:!1,disableScrolling:!1,sanitizeTitle:!1},e.prototype.option=function(e){t.extend(this.options,e)},e.prototype.imageCountLabel=function(t,e){return this.options.albumLabel.replace(/%1/g,t).replace(/%2/g,e)},e.prototype.init=function(){var e=this;t(document).ready(function(){e.enable(),e.build()})},e.prototype.enable=function(){var e=this;t("body").on("click","a[rel^=lightbox], area[rel^=lightbox], a[data-lightbox], area[data-lightbox]",function(i){return e.start(t(i.currentTarget)),!1})},e.prototype.build=function(){if(!(t("#lightbox").length>0)){var e=this;t('<div id="lightboxOverlay" class="lightboxOverlay"></div><div id="lightbox" class="lightbox"><div class="lb-outerContainer"><div class="lb-container"><img class="lb-image" src="data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==" /><div class="lb-nav"><a class="lb-prev" href="" ></a><a class="lb-next" href="" ></a></div><div class="lb-loader"><a class="lb-cancel"></a></div></div></div><div class="lb-dataContainer"><div class="lb-data"><div class="lb-details"><span class="lb-caption"></span><span class="lb-number"></span></div><div class="lb-closeContainer"><a class="lb-close"></a></div></div></div></div>').appendTo(t("body")),this.$lightbox=t("#lightbox"),this.$overlay=t("#lightboxOverlay"),this.$outerContainer=this.$lightbox.find(".lb-outerContainer"),this.$container=this.$lightbox.find(".lb-container"),this.$image=this.$lightbox.find(".lb-image"),this.$nav=this.$lightbox.find(".lb-nav"),this.containerPadding={top:parseInt(this.$container.css("padding-top"),10),right:parseInt(this.$container.css("padding-right"),10),bottom:parseInt(this.$container.css("padding-bottom"),10),left:parseInt(this.$container.css("padding-left"),10)},this.imageBorderWidth={top:parseInt(this.$image.css("border-top-width"),10),right:parseInt(this.$image.css("border-right-width"),10),bottom:parseInt(this.$image.css("border-bottom-width"),10),left:parseInt(this.$image.css("border-left-width"),10)},this.$overlay.hide().on("click",function(){return e.end(),!1}),this.$lightbox.hide().on("click",function(i){return"lightbox"===t(i.target).attr("id")&&e.end(),!1}),this.$outerContainer.on("click",function(i){return"lightbox"===t(i.target).attr("id")&&e.end(),!1}),this.$lightbox.find(".lb-prev").on("click",function(){return 0===e.currentImageIndex?e.changeImage(e.album.length-1):e.changeImage(e.currentImageIndex-1),!1}),this.$lightbox.find(".lb-next").on("click",function(){return e.currentImageIndex===e.album.length-1?e.changeImage(0):e.changeImage(e.currentImageIndex+1),!1}),this.$nav.on("mousedown",function(t){3===t.which&&(e.$nav.css("pointer-events","none"),e.$lightbox.one("contextmenu",function(){setTimeout(function(){this.$nav.css("pointer-events","auto")}.bind(e),0)}))}),this.$lightbox.find(".lb-loader, .lb-close").on("click",function(){return e.end(),!1})}},e.prototype.start=function(e){function i(t){n.album.push({alt:t.attr("data-alt"),link:t.attr("href"),title:t.attr("data-title")||t.attr("title")})}var n=this,a=t(window);a.on("resize",t.proxy(this.sizeOverlay,this)),t("select, object, embed").css({visibility:"hidden"}),this.sizeOverlay(),this.album=[];var o,r=0,s=e.attr("data-lightbox");if(s){o=t(e.prop("tagName")+'[data-lightbox="'+s+'"]');for(var h=0;h<o.length;h=++h)i(t(o[h])),o[h]===e[0]&&(r=h)}else if("lightbox"===e.attr("rel"))i(e);else{o=t(e.prop("tagName")+'[rel="'+e.attr("rel")+'"]');for(var l=0;l<o.length;l=++l)i(t(o[l])),o[l]===e[0]&&(r=l)}var d=a.scrollTop()+this.options.positionFromTop,c=a.scrollLeft();this.$lightbox.css({top:d+"px",left:c+"px"}).fadeIn(this.options.fadeDuration),this.options.disableScrolling&&t("html").addClass("lb-disable-scrolling"),this.changeImage(r)},e.prototype.changeImage=function(e){var i=this;this.disableKeyboardNav();var n=this.$lightbox.find(".lb-image");this.$overlay.fadeIn(this.options.fadeDuration),t(".lb-loader").fadeIn("slow"),this.$lightbox.find(".lb-image, .lb-nav, .lb-prev, .lb-next, .lb-dataContainer, .lb-numbers, .lb-caption").hide(),this.$outerContainer.addClass("animating");var a=new Image;a.onload=function(){var o,r,s,h,l,d;n.attr({alt:i.album[e].alt,src:i.album[e].link}),t(a),n.width(a.width),n.height(a.height),i.options.fitImagesInViewport&&(d=t(window).width(),l=t(window).height(),h=d-i.containerPadding.left-i.containerPadding.right-i.imageBorderWidth.left-i.imageBorderWidth.right-20,s=l-i.containerPadding.top-i.containerPadding.bottom-i.imageBorderWidth.top-i.imageBorderWidth.bottom-120,i.options.maxWidth&&i.options.maxWidth<h&&(h=i.options.maxWidth),i.options.maxHeight&&i.options.maxHeight<h&&(s=i.options.maxHeight),(a.width>h||a.height>s)&&(a.width/h>a.height/s?(r=h,o=parseInt(a.height/(a.width/r),10),n.width(r),n.height(o)):(o=s,r=parseInt(a.width/(a.height/o),10),n.width(r),n.height(o)))),i.sizeContainer(n.width(),n.height())},a.src=this.album[e].link,this.currentImageIndex=e},e.prototype.sizeOverlay=function(){this.$overlay.width(t(document).width()).height(t(document).height())},e.prototype.sizeContainer=function(t,e){function i(){n.$lightbox.find(".lb-dataContainer").width(r),n.$lightbox.find(".lb-prevLink").height(s),n.$lightbox.find(".lb-nextLink").height(s),n.showImage()}var n=this,a=this.$outerContainer.outerWidth(),o=this.$outerContainer.outerHeight(),r=t+this.containerPadding.left+this.containerPadding.right+this.imageBorderWidth.left+this.imageBorderWidth.right,s=e+this.containerPadding.top+this.containerPadding.bottom+this.imageBorderWidth.top+this.imageBorderWidth.bottom;a!==r||o!==s?this.$outerContainer.animate({width:r,height:s},this.options.resizeDuration,"swing",function(){i()}):i()},e.prototype.showImage=function(){this.$lightbox.find(".lb-loader").stop(!0).hide(),this.$lightbox.find(".lb-image").fadeIn(this.options.imageFadeDuration),this.updateNav(),this.updateDetails(),this.preloadNeighboringImages(),this.enableKeyboardNav()},e.prototype.updateNav=function(){var t=!1;try{document.createEvent("TouchEvent"),t=!!this.options.alwaysShowNavOnTouchDevices}catch(t){}this.$lightbox.find(".lb-nav").show(),this.album.length>1&&(this.options.wrapAround?(t&&this.$lightbox.find(".lb-prev, .lb-next").css("opacity","1"),this.$lightbox.find(".lb-prev, .lb-next").show()):(this.currentImageIndex>0&&(this.$lightbox.find(".lb-prev").show(),t&&this.$lightbox.find(".lb-prev").css("opacity","1")),this.currentImageIndex<this.album.length-1&&(this.$lightbox.find(".lb-next").show(),t&&this.$lightbox.find(".lb-next").css("opacity","1"))))},e.prototype.updateDetails=function(){var e=this;if(void 0!==this.album[this.currentImageIndex].title&&""!==this.album[this.currentImageIndex].title){var i=this.$lightbox.find(".lb-caption");this.options.sanitizeTitle?i.text(this.album[this.currentImageIndex].title):i.html(this.album[this.currentImageIndex].title),i.fadeIn("fast").find("a").on("click",function(e){void 0!==t(this).attr("target")?window.open(t(this).attr("href"),t(this).attr("target")):location.href=t(this).attr("href")})}if(this.album.length>1&&this.options.showImageNumberLabel){var n=this.imageCountLabel(this.currentImageIndex+1,this.album.length);this.$lightbox.find(".lb-number").text(n).fadeIn("fast")}else this.$lightbox.find(".lb-number").hide();this.$outerContainer.removeClass("animating"),this.$lightbox.find(".lb-dataContainer").fadeIn(this.options.resizeDuration,function(){return e.sizeOverlay()})},e.prototype.preloadNeighboringImages=function(){this.album.length>this.currentImageIndex+1&&((new Image).src=this.album[this.currentImageIndex+1].link),this.currentImageIndex>0&&((new Image).src=this.album[this.currentImageIndex-1].link)},e.prototype.enableKeyboardNav=function(){t(document).on("keyup.keyboard",t.proxy(this.keyboardAction,this))},e.prototype.disableKeyboardNav=function(){t(document).off(".keyboard")},e.prototype.keyboardAction=function(t){var e=t.keyCode,i=String.fromCharCode(e).toLowerCase();27===e||i.match(/x|o|c/)?this.end():"p"===i||37===e?0!==this.currentImageIndex?this.changeImage(this.currentImageIndex-1):this.options.wrapAround&&this.album.length>1&&this.changeImage(this.album.length-1):"n"!==i&&39!==e||(this.currentImageIndex!==this.album.length-1?this.changeImage(this.currentImageIndex+1):this.options.wrapAround&&this.album.length>1&&this.changeImage(0))},e.prototype.end=function(){this.disableKeyboardNav(),t(window).off("resize",this.sizeOverlay),this.$lightbox.fadeOut(this.options.fadeDuration),this.$overlay.fadeOut(this.options.fadeDuration),t("select, object, embed").css({visibility:"visible"}),this.options.disableScrolling&&t("html").removeClass("lb-disable-scrolling")},new e}),function(t){"function"==typeof define&&define.amd?define(["jquery"],t):t("object"==typeof exports?require("jquery"):jQuery)}(function(t){var e,i=navigator.userAgent,n=/iphone/i.test(i),a=/chrome/i.test(i),o=/android/i.test(i);t.mask={definitions:{9:"[0-9]",a:"[A-Za-z]","*":"[A-Za-z0-9]"},autoclear:!0,dataName:"rawMaskFn",placeholder:"_"},t.fn.extend({caret:function(t,e){var i;if(0!==this.length&&!this.is(":hidden"))return"number"==typeof t?(e="number"==typeof e?e:t,this.each(function(){this.setSelectionRange?this.setSelectionRange(t,e):this.createTextRange&&((i=this.createTextRange()).collapse(!0),i.moveEnd("character",e),i.moveStart("character",t),i.select())})):(this[0].setSelectionRange?(t=this[0].selectionStart,e=this[0].selectionEnd):document.selection&&document.selection.createRange&&(i=document.selection.createRange(),t=0-i.duplicate().moveStart("character",-1e5),e=t+i.text.length),{begin:t,end:e})},unmask:function(){return this.trigger("unmask")},mask:function(i,r){var s,h,l,d,c,g,u,b;if(!i&&this.length>0){var f=(s=t(this[0])).data(t.mask.dataName);return f?f():void 0}return r=t.extend({autoclear:t.mask.autoclear,placeholder:t.mask.placeholder,completed:null},r),h=t.mask.definitions,l=[],d=u=i.length,c=null,t.each(i.split(""),function(t,e){"?"==e?(u--,d=t):h[e]?(l.push(new RegExp(h[e])),null===c&&(c=l.length-1),t<d&&(g=l.length-1)):l.push(null)}),this.trigger("unmask").each(function(){function s(){if(r.completed){for(var t=c;t<=g;t++)if(l[t]&&A[t]===f(t))return;r.completed.call(k)}}function f(t){return t<r.placeholder.length?r.placeholder.charAt(t):r.placeholder.charAt(0)}function m(t){for(;++t<u&&!l[t];);return t}function p(t){for(;--t>=0&&!l[t];);return t}function v(t,e){var i,n;if(!(t<0)){for(i=t,n=m(e);i<u;i++)if(l[i]){if(!(n<u&&l[i].test(A[n])))break;A[i]=A[n],A[n]=f(n),n=m(n)}w(),k.caret(Math.max(c,t))}}function x(t){var e,i,n,a;for(e=t,i=f(t);e<u;e++)if(l[e]){if(n=m(e),a=A[e],A[e]=i,!(n<u&&l[n].test(a)))break;i=a}}function I(t){$(),k.val()!=D&&k.change()}function y(t,e){var i;for(i=t;i<e&&i<u;i++)l[i]&&(A[i]=f(i))}function w(){k.val(A.join(""))}function $(t){var e,i,n,a=k.val(),o=-1;for(e=0,n=0;e<u;e++)if(l[e]){for(A[e]=f(e);n++<a.length;)if(i=a.charAt(n-1),l[e].test(i)){A[e]=i,o=e;break}if(n>a.length){y(e+1,u);break}}else A[e]===a.charAt(n)&&n++,e<d&&(o=e);return t?w():o+1<d?r.autoclear||A.join("")===C?(k.val()&&k.val(""),y(0,u)):w():(w(),k.val(k.val().substring(0,o+1))),d?e:c}var k=t(this),A=t.map(i.split(""),function(t,e){if("?"!=t)return h[t]?f(e):t}),C=A.join(""),D=k.val();k.data(t.mask.dataName,function(){return t.map(A,function(t,e){return l[e]&&t!=f(e)?t:null}).join("")}),k.one("unmask",function(){k.off(".mask").removeData(t.mask.dataName)}).on("focus.mask",function(){if(!k.prop("readonly")){clearTimeout(e);var t;D=k.val(),t=$(),e=setTimeout(function(){k.get(0)===document.activeElement&&(w(),t==i.replace("?","").length?k.caret(0,t):k.caret(t))},10)}}).on("blur.mask",I).on("keydown.mask",function(t){if(!k.prop("readonly")){var e,i,a,o=t.which||t.keyCode;b=k.val(),8===o||46===o||n&&127===o?(i=(e=k.caret()).begin,(a=e.end)-i==0&&(i=46!==o?p(i):a=m(i-1),a=46===o?m(a):a),y(i,a),v(i,a-1),t.preventDefault()):13===o?I.call(this,t):27===o&&(k.val(D),k.caret(0,$()),t.preventDefault())}}).on("keypress.mask",function(e){if(!k.prop("readonly")){var i,n,a,r=e.which||e.keyCode,h=k.caret();e.ctrlKey||e.altKey||e.metaKey||r<32||!r||13===r||(h.end-h.begin!=0&&(y(h.begin,h.end),v(h.begin,h.end-1)),(i=m(h.begin-1))<u&&(n=String.fromCharCode(r),l[i].test(n))&&(x(i),A[i]=n,w(),a=m(i),o?setTimeout(function(){t.proxy(t.fn.caret,k,a)()},0):k.caret(a),h.begin<=g&&s()),e.preventDefault())}}).on("input.mask paste.mask",function(){k.prop("readonly")||setTimeout(function(){var t=$(!0);k.caret(t),s()},0)}),a&&o&&k.off("input.mask").on("input.mask",function(t){console.log(k);var e=k.val(),i=k.caret();if(b&&b.length&&b.length>e.length){for($(!0);i.begin>0&&!l[i.begin-1];)i.begin--;if(0===i.begin)for(;i.begin<c&&!l[i.begin];)i.begin++;k.caret(i.begin,i.begin)}else{$(!0);var n=e.charAt(i.begin);i.begin<u&&(l[i.begin]?l[i.begin].test(n)&&i.begin++:(i.begin++,l[i.begin].test(n)&&i.begin++)),k.caret(i.begin,i.begin)}s()}),$()})}})});